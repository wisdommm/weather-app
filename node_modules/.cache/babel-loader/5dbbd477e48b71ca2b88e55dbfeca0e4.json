{"ast":null,"code":"import _asyncToGenerator from\"/Users/wanyan/Desktop/test1234/weather/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/wanyan/Desktop/test1234/weather/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/wanyan/Desktop/test1234/weather/node_modules/@babel/runtime/regenerator/index.js\";import weatherLogo from'./image';import Detail from'./detail';import'./App.css';import{useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var dayMap=['周日','周一','周二','周三','周四','周五','周六'];function App(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),now=_useState2[0],setNow=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),hourRes=_useState4[0],setHourRes=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),dayRes=_useState6[0],setDayRes=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),page=_useState8[0],setPage=_useState8[1];useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:requestWeather();case 1:case\"end\":return _context.stop();}}},_callee);})),[]);var requestWeather=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var hour_result,hourList,day_result,weatherList;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch('https://devapi.qweather.com/v7/weather/now?location=101210106&key=d822b681e139418ea3e02807da626ada').then(function(data){return data.json();});case 2:hour_result=_context2.sent;if(!(hour_result.code==='200')){_context2.next=9;break;}setNow(hour_result.now);hourList=Array(24).fill(hour_result.now).map(function(e,index){var temp;if(Math.random()<0.5){temp=+e.temp+Math.random()*8;}else{temp=+e.temp-Math.random()*8;}var hour=new Date(+new Date()+3600000*index).getHours();return Object.assign({},e,{hour:hour,temp:Math.floor(temp)});});setHourRes(hourList);_context2.next=10;break;case 9:throw new Error('request error');case 10:_context2.next=12;return fetch('https://devapi.qweather.com/v7/weather/3d?location=101210106&key=d822b681e139418ea3e02807da626ada').then(function(data){return data.json();});case 12:day_result=_context2.sent;if(!(day_result.code==='200')){_context2.next=19;break;}weatherList=day_result.daily;weatherList=weatherList.concat(weatherList,weatherList[0]).map(function(item,index){var time=+new Date()+86400000*index;var year=new Date(time).getFullYear();var monuth=new Date(time).getMonth()+1;var date=new Date(time).getDate();var fxDate=\"\".concat(year,\"-\").concat(monuth,\"-\").concat(date);return Object.assign({},item,{fxDate:fxDate});});setDayRes(weatherList);_context2.next=20;break;case 19:throw new Error('request error');case 20:case\"end\":return _context2.stop();}}},_callee2);}));return function requestWeather(){return _ref2.apply(this,arguments);};}();var nowTime=new Date(now.obsTime);var timeText=dayMap[nowTime.getDay()]+' '+nowTime.getHours()+(nowTime.getHours()>12?'pm':'am');var weather=function weather(text){if(text){var _now$text,_now$text2,_now$text3;return text.includes('雨')?'rain':(_now$text=now.text)!==null&&_now$text!==void 0&&_now$text.includes('雪')?'snow':(_now$text2=now.text)!==null&&_now$text2!==void 0&&_now$text2.includes('晴')?'sun':(_now$text3=now.text)!==null&&_now$text3!==void 0&&_now$text3.includes('云')?'cloud':'overcast';}return'';};return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:page===1?/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"weatherLogo\",src:weatherLogo[weather(now.text)],style:{opacity:now.text?1:0}}),/*#__PURE__*/_jsx(\"div\",{className:\"position\",children:\"\\u676D\\u5DDE\\u5E02, \\u6D59\\u6C5F\\u7701\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"description\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"temperature\",children:[now.temp||'*',/*#__PURE__*/_jsx(\"span\",{className:\"icon\",children:\"\\xB0c\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"date\",children:now.obsTime?timeText:'*'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"desc1\",children:now.windDir}),/*#__PURE__*/_jsx(\"span\",{className:\"desc1 desc2\",children:now.text})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"detail\",onClick:function onClick(){return setPage(2);},children:\"\\u8BE6\\u60C5\"})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"ul\",{className:\"tips\",children:[/*#__PURE__*/_jsxs(\"li\",{className:\"item\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"img\",{className:\"icon\",src:weatherLogo.rainIcon}),\"\\u964D\\u6C34\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"tip\",children:[now.vis,\"%\"]})]}),/*#__PURE__*/_jsxs(\"li\",{className:\"item\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"img\",{className:\"icon temIcon\",src:weatherLogo.temIcon}),\"\\u6E7F\\u5EA6\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"tip\",children:[now.humidity,\"%\"]})]}),/*#__PURE__*/_jsxs(\"li\",{className:\"item\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"img\",{className:\"icon\",src:weatherLogo.windIcon}),\"\\u98CE\\u901F\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"tip\",children:[now.windSpeed,\"km/h\"]})]})]})})]}):/*#__PURE__*/_jsx(Detail,{setPage:setPage,hourRes:hourRes,dayMap:dayMap,weather:weather,dayRes:dayRes,now:now})});}export default App;","map":{"version":3,"sources":["/Users/wanyan/Desktop/test1234/weather/src/App.js"],"names":["weatherLogo","Detail","useEffect","useState","dayMap","App","now","setNow","hourRes","setHourRes","dayRes","setDayRes","page","setPage","requestWeather","fetch","then","data","json","hour_result","code","hourList","Array","fill","map","e","index","temp","Math","random","hour","Date","getHours","Object","assign","floor","Error","day_result","weatherList","daily","concat","item","time","year","getFullYear","monuth","getMonth","date","getDate","fxDate","nowTime","obsTime","timeText","getDay","weather","text","includes","opacity","windDir","rainIcon","vis","temIcon","humidity","windIcon","windSpeed"],"mappings":"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","sourcesContent":["import weatherLogo from './image';\nimport Detail from './detail';\nimport './App.css';\nimport { useEffect, useState } from 'react';\n\nconst dayMap = ['周日','周一','周二','周三','周四','周五','周六',];\n\nfunction App() {\n  const [now, setNow] = useState({});\n  const [hourRes, setHourRes] = useState([]);\n  const [dayRes, setDayRes] = useState([]);\n  const [page, setPage] = useState(1);\n\n  useEffect(async () => {\n    requestWeather();\n  }, []);\n\n  const requestWeather = async () => {\n    // 当前及24h数据\n    const hour_result = await fetch('https://devapi.qweather.com/v7/weather/now?location=101210106&key=d822b681e139418ea3e02807da626ada').then(data => data.json());\n    if (hour_result.code === '200') {\n      setNow(hour_result.now);\n      const hourList = Array(24).fill(hour_result.now).map((e, index) => {\n        let temp;\n        if (Math.random() < 0.5) {\n          temp = +e.temp + Math.random() * 8;\n        } else {\n          temp = +e.temp - Math.random() * 8;\n        }\n        const hour = new Date(+new Date() + 3600000 * index).getHours();\n        return Object.assign({}, e, {\n          hour,\n          temp: Math.floor(temp)\n        });\n      });\n      setHourRes(hourList);\n    } else {\n      throw new Error('request error');\n    }\n    // 未来7d数据\n    const day_result = await fetch('https://devapi.qweather.com/v7/weather/3d?location=101210106&key=d822b681e139418ea3e02807da626ada').then(data => data.json());\n    if (day_result.code === '200') {\n      let weatherList = day_result.daily;\n      weatherList = weatherList.concat(weatherList, weatherList[0]).map((item, index) => {\n        const time = +new Date() + 86400000 * index;\n        const year = new Date(time).getFullYear();\n        const monuth = new Date(time).getMonth() + 1;\n        const date = new Date(time).getDate();\n        const fxDate = `${year}-${monuth}-${date}`;\n        return Object.assign({}, item, {\n          fxDate,\n        });\n      });\n      setDayRes(weatherList);\n    } else {\n      throw new Error('request error');\n    }\n  };\n  const nowTime = new Date(now.obsTime);\n  const timeText = dayMap[nowTime.getDay()] + ' ' + nowTime.getHours() + (nowTime.getHours() > 12 ? 'pm' : 'am');\n  const weather = (text) => {\n    if (text) {\n      return text.includes('雨') ? 'rain' : \n      now.text?.includes('雪') ? 'snow' : \n      now.text?.includes('晴') ? 'sun' :\n      now.text?.includes('云') ? 'cloud' : 'overcast';\n    }\n    return '';\n  }\n  return (\n    <div className=\"App\">\n      {\n        page === 1 ? <div className=\"container\">\n        <div className=\"content\">\n          <img\n            className=\"weatherLogo\"\n            src={weatherLogo[weather(now.text)]}\n            style={{\n              opacity: now.text ? 1 : 0\n            }}\n          />\n          <div className=\"position\">杭州市, 浙江省</div>\n          <div className=\"description\">\n            <div className=\"wrapper\">\n              <span className=\"temperature\">{now.temp || '*'}<span className=\"icon\">°c</span></span>\n              <span className=\"date\">{now.obsTime ? timeText : '*'}</span>\n            </div>\n            <div className=\"wrapper\">\n              <span className=\"desc1\">{now.windDir}</span>\n              <span className=\"desc1 desc2\">{now.text}</span>\n            </div>\n          </div>\n          <div className=\"detail\" onClick={() => setPage(2)}>详情</div>\n        </div>\n        <div>\n          <ul className=\"tips\">\n            <li className=\"item\">\n              <span>\n                <img className=\"icon\" src={weatherLogo.rainIcon} />降水\n              </span>\n              <span className=\"tip\">{now.vis}%</span>\n            </li>\n            <li className=\"item\">\n              <span>\n                <img className=\"icon temIcon\" src={weatherLogo.temIcon} />湿度\n              </span>\n              <span className=\"tip\">{now.humidity}%</span>\n            </li>\n            <li className=\"item\">\n              <span>\n                <img className=\"icon\" src={weatherLogo.windIcon} />风速\n              </span>\n              <span className=\"tip\">{now.windSpeed}km/h</span>\n            </li>\n          </ul>\n        </div>\n      </div> : <Detail setPage={setPage} hourRes={hourRes} dayMap={dayMap} weather={weather} dayRes={dayRes} now={now} />\n      }\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}